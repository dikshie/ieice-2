%% template for IEICE Transactions
%% v1.7new [2010/02/03]
\documentclass[paper]{ieice}
%\documentclass[invited]{ieice}
%\documentclass[survey]{ieice}
%\documentclass[invitedsurvey]{ieice}
%\documentclass[review]{ieice}
%\documentclass[tutorial]{ieice}
%\documentclass[letter]{ieice}
%\documentclass[brief]{ieice}
\usepackage[dvips]{graphicx}
\usepackage[fleqn]{amsmath}
\usepackage[varg]{txfonts}
\usepackage{url}
\usepackage{cite}
\usepackage{epsfig}
\usepackage{float}
\usepackage{caption}
%\usepackage{subcaption}
\usepackage{graphicx}
%\usepackage[ngerman]{babel}
%\usepackage[T1]{fontenc}
%\captionsetup[subfigure]{labelformat=parens, format=hang, margin=0pt, parskip=0pt,
%		hangindent=0pt, indention=0pt, singlelinecheck=false, textfont=footnotesize}

\setcounter{page}{1}
%\breakauthorline{}% breaks lines after the n-th author

\field{B}
%\SpecialIssue{}
\SpecialSection{on XXXYYYZZZ}
%\theme{}
\title{Towards Sustainable Content Delivery with Peer-Assisted CDN}
%
%\title[title for header]{title}
\authorlist{% fill arguments of \authorentry, otherwise error will be caused. 
 \authorentry[dikshie@sfc.wide.ad.jp]{{Mohamad Dikshie} Fauzie}{n}{labelA}
 \authorentry{{Achmad Husni} Thamrin}{n}{labelA}
% \authorentry{Rodney Van Meter}{n}{labelB}
 \authorentry{Jun Murai}{m}{labelB}
}
\affiliate[labelA]{The author is with Graduate School of Media and Governance Keio University, Fujisawa-shi, 252-0882 Japan }
\affiliate[labelB]{The author is with Faculty of Environment and Information Studies Keio University, Fujisawa-shi, 252-0882 Japan }

%\paffiliate[present affiliate label]{Presently, the author is with the }
\received{2010}{1}{1}
\revised{2010}{1}{1}
%\finalreceived{2010}{1}{1}

%% <local definitions here>
%% </local definitions here>

\begin{document}
\maketitle

\begin{summary}
Users are watching increasing amounts of video over the Internet,
for which ISPs must be prepared.  Of course, ISPs want to minimize
the cost of delivering content to users.  Due to the business and
technical complexity of content delivery networks (CDNs), CDN
managed ISP/Telco and the initiatives for CDN interconnection are
soared in the recent years.  On the other hand, the deployment of
FTTx and xDSL is rising, increasing the technical opportunity for
truly broadly distributed servers.  We propose a network model of a
peer-assisted CDN that involves cooperation between an ISP/Telco
that manages its own CDN and its customers/users where the
peer-assisted application is run on top of the customer's home
gateway.  We use a simple stochastic fluid model (stationary and
stationary with churn) that seeks the different between ISP/Telco
that using CDN only and ISP/Telco that using peer-assisted CDN in
delivering video stream. We propose different admission policy by
CDN for peers to join peer-assisted swarms.  We give the results of
a simple techno-economic analysis based on ISP game strategies.

Our simple approach correctly models the ratio of leechers to
seeders based on the upload rate of seeders for stationary and for
stationary with churn.  We found that the upload rate of seeders has
a big impact on the systems.  Bigger upload means, ISP CDN can
minimize cost of delivery to users.  Upload rate of seeders has
bigger impact compare to discount price


\end{summary}
\begin{keywords}
P2P, CDN, ISP, Game Strategy
\end{keywords}  

%%%%%%%%%%%%%%%%%%%%%%%%%% INTRODUCTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{intro}
Streaming content, especially video, represents a significant fraction
of the traffic volume on the Internet, and it has become a standard
practice to deliver this type of content using Content Delivery
Networks (CDNs) such as Akamai and Limelight for better scaling and
quality of experience for the end users.  For example, Youtube uses
Google cache and MTV uses Akamai in their operations.

With the spread of broadband Internet access at a reasonable flat
monthly rate, users are connected to the Internet 24 hours a day and
they can download and share multimedia content.  P2P (peer to peer)
applications are also widely deployed.  In China, P2P is very popular;
we see many P2P applications from China such as PPLive, PPStream,
UUSe, Xunlei, etc.  Some news broadcasters also rely on P2P technology
to deliver popular live events.  For example, CNN uses the Octoshape
solution that enables their broadcast to scale and offer good video
quality as the number of users increases.

From the Internet provider point of view, the presence of so many
always-on users suggests that it is possible to delegate a portion of
computing, storage and networking tasks to the users, thus creating
P2P networks where users can share files and multimedia content.
Starting from file sharing protocols, P2P architectures have evolved
toward video on demand and support for live events.

A P2P based architecture usually requires a sufficient number of nodes
supplying the data (seeders) to start the distribution process among
the joining peers.  A peer usually offers a low outbound streaming
rate due to the traditional asymmetrical DSL home connectivity and
hence multiple peers must jointly stream contents to a requesting peer
(leecher).  The decentralized, uncoordinated operation implies that
scaling to high number of peers comes with side effects.  Typical
problems of a P2P streaming architecture are low stream quality with
undesirable disruptions, resource unfairness due to heterogeneous peer
resources, and high startup delay.  Moreover, current P2P applications
are not aware of the underlying network and may conflict with the ISP
routing policies and business model.

A number of P2P streaming applications have been designed, analyzed
and deployed, attracting a significant number of users.  Research
studies and deployment experiences have both demonstrated that P2P is
a promising solution in terms of scalability and deployment costs.  On
the other hand, the heterogeneous nature and unstable behavior of the
peers contributing bandwidth and computational resources, along with
the networking issues, affect the user experience and limit the
commercial success of P2P video streaming applications.
Alternatively, video contents can be efficiently distributed on
services offered by managed network architectures and CDN companies.
The major issues of CDN are high deployment cost and good but not
unlimited scalability in the long term.  Given the complementary
features of P2P and CDN, in recent years some hybrid solutions have
been proposed \cite{Huang:2008:UHC:1496046.1496064,4772628,Yin:2009:DDH:1631272.1631279}
to take the best of both approaches.

Broadband network access helps P2P applications to perform better.
xDSL networks are deployed worldwide, and in some countries, such as
Japan, even higher bandwidth fiber to the home (FTTH) already exceeds
DSL in market penetration.  In the coming years, FTTH will be massively
deployed by network operators throughout the world.  As access
bandwidth increases, P2P systems may become more efficient since a
peer can contribute much more.

P2P architecture offers great potential for content providers to cost
effectively distribute content by capitalizing on the network
resources already deployed for end users.  It is economically superior
to the traditional client-server architecture and it has been
demonstrated by lots of academic work and successful commercial
systems \cite{Yin:2009:DDH:1631272.1631279}.  We believe more content
providers will adopt P2P technology in the future.

Typically, each end user device is involved directly in the P2P swarm,
both to receive the benefits of P2P and to serve others.  In such
cases, the installation of P2P software in every end device is
necessary and the user is directly involved in the content's swarm.
Under such conditions, the disposition of peers may result in unstable
behavior and the swarm can be affected by the rapid and frequent
disconnections that are common for mobile devices.  Furthermore,
users' devices usually can contribute to the swarm only with limited
upload bandwidth.  In addition, techniques developed to select P2P
neighboring peers are often unfriendly toward the ISP's routing
policies.

Different topologies have been proposed in the literature, such as
those where the collaborative mechanism for content distribution is
created among more stable devices such as residential gateways.  The
residential gateway (i.e., a home gateway placed in at the user's
premises, serving several terminals within the home network but
directly managed by ISP) is considered the central entity for a
managed P2P infrastructure
\cite{Misra:2010:IPS:1811099.1811064,Cha:2008:NTP:1855641.1855646}.
Running on more stable and powerful devices, each gateway peer can
contribute more bandwidth to the content swarm compared to the
traditional end-user P2P systems.  Peer selection procedures can be
managed directly by the ISP, with the goal of avoiding the traversal
of multiple nodes across ISP boundaries.  Since P2P traffic is now
decreasing and moving to the cloud
\cite{Labovitz:2010:IIT:2043164.1851194}, there is plenty of headroom
for the ISP to use the gateway in a peer-assisted CDN, and the
always-on nature of the gateway makes it the perfect device to run
peer-assisted applications.  ISPs may even be willing to give rebates
to users who allow their gateways to be used, since the ISP benefits from incorporating the gateway into their CDN.  With the growing
interest to interconnect CDNs \cite{cdni,oceanproject}, this
architecture can benefit the ISP.

In this paper, we study the incentive for adopting peer assisted CDN for streaming and show its advantages.


\begin{figure}[tb]
\begin{center}
\includegraphics[scale=0.4]{graphs/business-relationship.eps}
\end{center}
\caption{Complex relationship of entities in Internet.
The data flow from content producer to content provider. 
Content producer such as movies companies send their movies to content provider for example: Netflix and Hulu.
Content providers then deliver the movies using CDN or they also can use their upstream provider.
Depends on routing and peering policy, data from CDN can flow directly to ISP or flow to ISP via IXP (Internet Exchange) or via transit network. 
Flow of data noted by straight arrow and flow of money noted by dash arrow line.
In current modern Internet topology, content provider and service provider can be merged in on entity, for example: Google.
Labovitz et al.,\cite{Labovitz:2010:IIT:2043164.1851194} mentioned that the hyper-giant entities such as Google doing massive peering to IXP in order to be closed to ISP. 
Although CDN is placed close to ISP network, it does not guarantee end-users can get good quality video stream \cite{Krishnan:2009:MBE:1644893.1644917}.
Other than technical complexity as mentioned before, CDN also faces economic complexity\cite{dispute}.
Therefore, the future of CDN business is likely to live deeper into ISP networks, more integrated into and interleaved with ISP infrastructures.}
\label{fig:businessrelationship}
\vspace{-2mm}
\end{figure} 

\begin{figure}[hb]
\begin{center}
\includegraphics[scale=0.4]{graphs/two-tier-cdn-topology.eps}
\end{center}
\caption{Two tier CDN-P2P topology.
The CDN proxy maintained by ISP. ISP also has CDN node. CDN node can exchange contents with other CDN node owned by other CDN companies.P2P nodes are ISP's customers that run P2P software.}
\label{fig:twotier}
\vspace{-2mm}
\end{figure} 


 
%%%%%%%%%%%%%%%% %%%%%% SYSTEM DESCRIPTION %%%%%%%%%%%%%%%%%%%%%%%
\section{System Description}\label{description}

Figure \ref{fig:twotier} shows the model of system architecture, consisted of two-level CDN (Level-1 and Level-0), and a P2P network.
This two level of CDN follows hierarchical model in Maki et al.,\cite{NaoyaMAKI2012} with modification.
The Level-1 CDN consists of high capacity servers strategically placed to increase network backbone capacity.
The Level-1 CDN is similar to the current CDN networks, where CDN nodes can communicate each other by using common interconnect interface even though the CDN nodes are owned by different companies or different ISPs \cite{cdni}.
The Level-0 CDN consists of CDN proxies owned or managed by an ISP and placed close to end users.
The CDN proxies join the P2P network along with other nodes owned by the end users.

The proxies communicate to each other to serve content requests from the users, serving the contents from their caches if the content is available 
or retrieving the content from the Level-1 CDN servers otherwise.
Some end user nodes assist the proxies to serve content requests by uploading the contents in their caches to other end user nodes, and a user node may receive the contents exclusively from the proxies or from the proxies and other user nodes, hence creating a P2P swarm.
The user nodes are configured not communicate with nodes outside the ISP network, thus the P2P swarm is limited to a single ISP (or an administrative domain).

In this P2P network, the proxies can be considered as super nodes, or super seeders, which serve all contents that cannot be served by other nodes.
The proxies also coordinate the user nodes, whether they act as seeders or leechers.
The proxies should satisfy all users while minimizing their resource usage, e.g., bandwidth and cache capacity, by optimizing the utilization of seeders in the P2P swarm.
In the case of file sharing, the proxies may not need to serve contents to the seeders if the upload rate from the user nodes in the P2P swarm is enough to satisfy all users.
While in the case of streaming contents, the proxies serve the contents in the full streaming rate to the seeders;
and the leechers would not receive the full rate from the proxies as they also receive contents from the seeders.
Also in this case, even though the upload rate from the user nodes in the P2P swarm is enough, relying only to user nodes may make some nodes experiencing high latency,
hence the proxies should have a good coordination strategy to satisfy the latency requirements.

Cost reduction in the ISP side is an aim of the introduction of this system, thus the ISP may offer incentives, e.g., a subscription fee discount, to its users in order to get them participating in the P2P swarm.
It should also devise a strategy or strategies of its offers in order to achieve its commercial objectives, including customer satisfaction.
The next section presents the analysis of this system and the strategies of an ISP in introducing this system.

  
 
%%%%%%%%%% SYSTEM MODEL %%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{System Model and Analysis}\label{systemmodel}
We present a model between P2P and CDN using simple a single bitrate for video streaming as shown in Fig.\ref{fig:twotier2}. 
The model is a stochastic fluid model similar to \cite{4215694}.
While the authors in \cite{4215694} focus on probability of degraded service on small and large systems, our work focus on minimum capacity or of CDN proxy to support the system.
Minimum capacity is very important to ISP for capacity planning.
On next subsection we also present a model of simple game theory between ISP who operate P2P-CDN and users.
We aim to find out the indifferent utility function between ISP and users.

\begin{figure}[tb] 
\begin{center}
\includegraphics[scale=0.45]{graphs/two-tier-cdn-topology-2.eps}
\end{center}
\caption{System architecture on Level-0. P2P nodes that run on user home gateway communicates to CDN proxy.
Let the upload capacity of each seeder as $u_s$ and we normalize $u_s$ to $r=1$, then  $0 \leq u_s \leq 1$.}
\label{fig:twotier2}
\vspace{-2mm}
\end{figure}

\subsection{System in Stationary State}

Let the number of leechers and the number of seeders in the P2P swarm, not including the CDN proxy, as $n_l$ and $n_s$, and the bitrate as $r$.
In order to satisfy the users for a streaming content, the minimum total upload bitrate to the P2P swarm is $(n_s + n_l)r$.
Let the upload capacity of each seeder as $u_s$, and we normalize $u_s$ to $r=1$, then $0 \leq u_s \leq 1$. Therefore the minimum CDN proxy capacity to support the system is:
\begin{equation}
        U_p = n_s.r + n_l.r - min(n_s.u_s.r, n_l.r).
\end{equation}
Note that if $n_l.r$ is less than the upload capacity of the seeders, the proxy does not need to serve the leechers.
Also note that if the system is for file sharing, then the CDN proxy does not need to serve the seeders.
From the above equation, we define $X=\frac{n_l}{n_s}$, which is the ratio of the number of leechers to the number of seeders, and we normalize $r=1$, hence:
\begin{equation}
        \frac{U_p}{n_s} = (1 + X - min (u_s,X)),
\end{equation}
which means that the upload capacity requirement of CDN proxy relative to the number of seeders will be higher as $X$ increases beyond $X = u_s$.

\begin{figure}[hb] 
\begin{center}
\includegraphics[scale=0.65]{graphs/stable-steady-state.eps}
\end{center}
\caption{System in stationary state.}
\label{fig:steadystate}
\vspace{-2mm}
\end{figure}

Figure \ref{fig:steadystate} shows the system in stationary state.
For $u_s=1.5$, the minimum required capacity CDN proxy relative to the number of seeders to support the system can be achieved if the ratio of leechers to seeders is less than $1.5$.
We see that the CDN proxy prefers a higher $u_s$ in the system.
A special case is $u_s = 0$, which is equivalent to no P2P swarm.
It is also clear that as $X$ increases, the CDN proxy must add its capacity, thus adding the cost for the ISP.

\begin{figure*}[thb]
\begin{minipage}[b]{0.4\linewidth}
\centering
\includegraphics[width=3.5in]{graphs/U_p_n_1000.eps}
\caption{$U_p$ for $N=1000$ for admission policy 1.}
\label{fig:U_p_1000_1}
\end{minipage}
\hspace{0.5cm}
\begin{minipage}[b]{0.68\linewidth}
\centering
\includegraphics[width=3.5in]{graphs/U_p_n_1000_admi.eps}
\caption{$U_p$ for $N=1000$ for admission policy 2.}
\label{fig:U_p_1000_2}
\end{minipage}
\end{figure*}

\subsection{System with Churn}\label{sec:stablesystemwithchurn}

In this analysis, we assume peers (user nodes) join at random times, stay in the system for random period of time, then leave.
We assume the peer arrivals follow a poisson process with rate $\lambda$, and peers stay in the system follow a general probability distribution with mean $\frac{1}{\gamma}$.
Let $N(t)$ be the number of peers in the system at time $t$, i.e., the number of nodes in a $M/G/\infty$ queue, thus we can denote $U_p$ as a function of time $t$
\begin{equation}
        U_p(t) = N(t)r - min(n_s(t) u_s r, (N(t) - n_s(t))r),
\end{equation}
where $N(t) = n_s(t) + n_l(t)$, and $n_s(t)$ is determined by the system's admission policy.

We now compare two admission policies:
1. the system starts admitting new arrivals as seeders until $(n_s.u_s > n_l)$, then each arrival is admitted as a seeder or a leecher according to the equation.     
2. the system admit arrivals every $d$ time interval. If $(n_s.u_s > n_l)$ at the beginning of a time interval, all arrivals within the time interval are admitted as leecher, otherwise as seeders.

Figure \ref{fig:U_p_1000_1} shows the $U_p$ values during simulation with $N=1000, \lambda=2, \mu=2, u_s=\{0.1, 0.5, 0.8\}$, and we use the first admission policy in this simulation. 
We also plot ratio values $X$ on the second Y-axis.
Figure \ref{fig:U_p_1000_2} shows the $U_p$ values during simulation using the second admission policy with $delta_t=1.0$ and other parameters are kept unchanged.  
From both figures, we can see that the first admission policy can stabilize the value $X$ in order to keep the CDN proxy capacity enough to supply the system. 
In the second admission policy, CDN proxy decides the same role for peers arriving in a time interval.
Figure \ref{fig:cdf} shows the CDF of $X$ for $U_s=0.1, U_s=0.5, \text{and }  U_s=0.8$ for both admission policies. 
We can see that second admission policy gives a higher variance, while first admission can keep the ratio ideal.
Finally, we can see that seeder upload has a good contribution to this system. 
The next section discusses how to give incentives to the peers in this system.

\begin{figure}[hb] 
\begin{center}
\includegraphics[scale=0.65]{graphs/cdf.eps}
\end{center}
\caption{CDF of $n_l/n_s$. We can see that the variance is higher for admission policy 2 compared to the admission policy 1.}
\label{fig:cdf}
\vspace{-2mm}
\end{figure}
 
\subsection{ISP Strategies: Game Theory Approach}
In this section, we present simple game theory approach for analysis of ISP strategies.
Game theory as described in \cite{gametheory} is a mathematical framework to study and analysis of situation where decisions made by a set of two or more rational players.
Basic element of game are: rational players, strategies, and payoff or utility.  
Rational players choose a strategy for maximizing its payoff or utility. 
Extensive-form game is representation of corresponding decision nodes in a directed tree.
Later, we will use extensive-form game to represent our game.
In our model, ISP has already attempted to implement solution for peer-assisted CDN.
Moreover, it is reasonable to assume that ISP is naturally initiators.  
Stackelberg game also known as a leader-follower game is a class of game that concerns with situation where one player, the leader, initiates the decision making and where the second player, the follower, responds to the actions by the leader.  
Moreover in our model, ISP can be modeled as leader who decided to implement peer-assisted or not according to their expected payoff, while users can be modeled as followers that evaluate the decision of the ISP and responds according to their available actions and payoffs.
In this section, we will focus on ISP side.  

\newtheorem{theorem}{Definition}
\begin{theorem}[ISP Strategies]
We define the pure strategy space $S_{isp}$ to include two strategies combination choice $s \in \{CDN, CDN-P2P\}$ and corresponding subscription free $P^{s}$.
Futhermore, we denote the strategies as:
\begin{itemize}
	\item $s_1 = (CDN, P^{s_1})$ : the ISP decides to use CDN only and thus keeps charging the initial subscription free $P^{s_1}$.
	\item $s_2 = (CDN-P2P, P^{s_2})$ : the ISP decides recommends peer-assisted and offers a subscription fee $P^{s_2} \le P^{s_1}$.
\end{itemize}
Where the ISP strategy space $S_{isp} = \{s_1,s_2\}$.
\end{theorem}

\begin{figure}[tb] 
\begin{center}
\includegraphics[scale=0.5]{graphs/game-tree-2.eps}
\end{center}
\caption{Extensive form of game between ISP's strategies}
\label{fig:gametree}
\vspace{-2mm}
\end{figure}

\subsubsection{ISP Payoff}

We now describe the payoff function for ISP in our model.  
We assume a profit maximizing ISP that gains higher utility in proportion to the increasing profit, which is only determined by the revenue from users and the bandwidth cost to reach the users.

For the revenue model, we assume that the ISP collects revenue solely by charging an initial flat rate subscription fee $P^{(s_1)}$ to its $N$ number of users who purchase internet access with equal and fixed quality of service.
ISPs are often price discriminatory towards its customers and thus operate with different price levels for different bandwidth or QoS.
ISPs are often get revenue from other businesses such as email hosting, web hosting, etc. 
In our model, we do not include such revenue, and we found it reasonable only to focus on users that buy the same internet access product. 
Given the above simplifications, the ISP collects a total revenue (when deciding on a strategy $s$) of $R = N P^{(s)}$.
The analysis focuses on the ISP side only, and we are very interested to see the difference ($\delta$) between payoff of strategy $s_1$ and strategy $s_2$.
For strategy $s_1$, the payoff for the ISP is: 

\begin{eqnarray}
	\pi^{(s_1)}_{(N)}&=& N P^{(s_1)} - N T P_t\\
\end{eqnarray}

For strategy $s_2$, ISP has payoff:
\begin{eqnarray}
	\pi^{(s_2)}_{(N)} &=& \pi^{(s_2)}_{(n_l)} + \pi^{(s_2)}_{(n_s)}\\
	\nonumber &=&n_l p^{(s_1)} - n_l T P_t + min (n_s u_s,n_l)T P_t\\
	&+&n_s P^{(s_2)} - n_s T P_t
\end{eqnarray}
In $n_l p^{(s_1)}$ we use $p^{(s_1)}$ because leechers are not join to peer-assisted mode offer by ISP thus the price is without discount.
We also note that $N=n_l + n_s$.
Therefore payoff difference between strategy $s_2$ and $s_1$ is:
\begin{eqnarray}
	\delta &=& n_l P^{(s_1)} + min (n_s u_s,n_l)T P_t \\
	&+& n_s P^{(s_2)} - N T Pt - N P^{(s_1)} + N T Pt\\
	&=& n_s (P^{(s_2)} - P^{(s_1)}) + min(n_s u_s , N-n_s) T P_t
\end{eqnarray}



Description of notation as follows:
\begin{itemize}
	\item $n_s$ is number of seeders.
	\item $n_l$ is number of leechers.
	\item $P^{(s_1)}$ is subscription fee for strategy $s_1$
	\item $P^{(s_2)}$ is subscription fee for strategy $s_2$ where it is discount price.
	\item $T$ is video traffic bitrate. 
	\item $P_t$ is transport cost. 
	\item $U_s$ is upload rate of seeders.
%	\item $\tau^{s_1}$ is traffic cost for strategy $s^{(s_1)}$.
%	\item $\tau^{s_2}$ is traffic cost for strategy $s^{(s_2)}$.
\end{itemize}
Explanation of notation as follows:
$N P^{(s_1)}$ is revenue in strategy $s_1$.  
$N T P_t$ is cost to deliver content to users in strategy $s_1$.
$n_l p^{(s_1)}$ and $n_s P^{(s_2)}$ is revenue in strategy $s_2$.
$n_l T P_t + min (n_s u_s,n_l)T P_t$ and $n_s T P_t$ is cost to deliver content to users in strategy $s_2$.
We also noted that $P^{(s_2)}$ is price that ISP give in strategy $s_2$. 
$P^{(s_2)}$ is discount price because users accept strategy $s_2$ to join peer-assisted CDN.  
We can get discount price by indifference payoff between strategy $s_1$ and $s_2$ with total peer $N$:
\begin{eqnarray}  
	\pi^{(s_1)}_{(N)} &=& \pi^{(s_2)}_{(N)}\\
	N.P^{(s_1)} - \tau^{(s_1)} &=& N.P^{(s_2)} - \tau^{(s_2)}\\
	P^{(s_2)} &=& P^{(s_1)} - \frac{1}{N} (\tau^{(s_1)} -  \tau^{(s_2)} ) 
\end{eqnarray}
Where $\tau^{(s_2)}$ is traffic cost for strategy $s_2$ and $\tau^{(s_2)}$ is traffic cost for strategy $s_1$.
Factor $\frac{1}{N} (\tau^{(s_1)} -  \tau^{(s_2)} )$ is discount factor.
We can define discount factor as $\frac{\gamma}{N} (\tau^{(s_1)} -  \tau^{(s_2)} )$.
Maximum discount that ISP can give to user when $\gamma=1$ and minimum discount that ISP can give to user when $\gamma=0$.
We can also say that $\gamma$ is a ratio that express how much of the ISP expected utility increase it wants to share with its users. 

\begin{figure}[th] 
\begin{center}
\includegraphics[scale=0.65]{graphs/plotpay.eps}
\end{center}
\caption{$\delta$ between strategy $s_1$ and $s_2$ with $U_s$ variation and $\gamma$ variation.
The peak of graph is the ISP maximum payoff with maximum number of seeders.
The left side before peak is the region where ISP can add more seeders.
The right side before peak is the region where ISP can not add seeder because the payoff is decreasing.}
\label{fig:delta}
\vspace{-2mm}
\end{figure}

 
\subsubsection{Numerical Result}
In this subsection we do numerical evaluation the ISP strategy.
The assumptions that we use for this numerical simulation:
\begin{itemize}
	\item We assume that  traffic is generated by video traffic and the traffic.
	\item We assume that user utilize $100\%$ of their internet connection capacity.  
	\item We assume users never turn off their home gateway so ISP do not need to give penalty to users.
	\item We assume there is no investment cost though ISP may need to give different firmware software to run peer-assisted application inside users home gateway. We assume that cost is very small thus we assume investment cost is zero.
\end{itemize}
Parameters value that we use in this numerical simulation as follows:
\begin{table}[thb]%[tb]
\caption{Parameters values for simulation}
\label{table:1}
\begin{center}
\begin{tabular}{c|c}
\hline
$u_s$ & $\{0.1, 0.5, 0.8\}$ \\
\hline
$N$ & $1000$\\
\hline
$T$ & $1$Mbps \\
\hline
$P_t$ & $10$USD \\
\hline
$P^{(s_1)}$ & $50$USD\\
\hline
$\gamma$ & $\{0.1,1.0\}$ \\
\hline
\end{tabular}
\end{center}
\end{table}

Figure \ref{fig:delta} shows difference payoff between strategy $s_1$ and $s_2$.
It shows clearly the inflection point where ISP get maximum payoff with maximum seeders. 
Thus the left side of line is the region where ISP still can add more seeders and the right side of line is the region where ISP can not add more seeders because the payoff is decreasing.
We summarize the numerical results in table \ref{table:2}.
\begin{table}[hb]%[tb]
\caption{Numerical Simulation Result}
\label{table:2}
\begin{center}
\begin{tabular}{c|c|c}
\hline
$u_s$ & $\gamma$ & $n_s$ \\
\hline
$0.1$ & $0.1$ & $909$ \\
\hline
$0.1$ & $1$ & $910$ \\
\hline
$0.5$ & $0.1$ & $666$ \\
\hline
$0.5$ & $1$ & $667$\\
\hline
$0.8$ & $0.1$ & $555$ \\
\hline
$0.8$ & $1$ & $556$ \\
\hline
\end{tabular}
\end{center}
\end{table}
It is clear that contribution of $\gamma$ to ISP is very small.
On the other side, contribution of seeder upload rate $u_s$ to ISP payoff is big.



%%%%%%%%%%%%%%%%% RELATED WORK %%%%%%%%%%%%%%%%%%%%%%%%
\section{Related Work} 
Content Distribution Networks with peer-assisted have been successfully deployed on the Internet, such as Akamai \cite{Huang:2008:UHC:1496046.1496064} and LiveSky \cite{Yin:2010:LEC:1823746.1823750}.
The Authors of \cite{Huang:2008:UHC:1496046.1496064} conclude from two real world traces  that hybrid CDN-P2P can significantly reduce the cost of content distribution and can scale to cope with exponential growth of Internet video content.
Yin et al., \cite{Yin:2010:LEC:1823746.1823750} described commercial operation of CDN with peer-assisted in China.   
LiveSky solved several challenges in the system design such as dynamic resource scaling of P2P, low startup latency, ease of P2P integration with the existing CDN infrastructure, and network friendliness and upload fairness in the P2P operation. 
Xu et al.,\cite{DBLP:journals/corr/abs-1212-4915} using game theory shows that right cooperative profit distribution of P2P can help ISP to maximize the utility. 
Their model can easily implemented to current Internet economic settlement.
Misra et al.,\cite{Misra:2010:IPS:1811099.1811064} also mentioned the importance of P2P architecture to support content delivery networks. 
The author uses cooperative game theory to formulate simple compensation rules for users who run P2P to support content delivery networks.  

The idea of telco or ISP managed CDN has been proposed in recent years.  
The complexity of CDN business makes telco and ISP want to managed their own CDN.
It has been shown that it is cost effective \cite{federation}\cite{norton2011internet}. 
Kamiyama et al., \cite{NoriakiKAMIYAMA2013} proposed optimally ISP operated CDN. 
Kamiyama et al., mentioned that to deliver large and rich Internet content to users, ISP needs to put their CDN in data center.
The locations are limited while the storage is large, makes this solution become effective, using optimum placement algorithm based on real ISP network topologies.
The authors found that inserting CDN to ISP's ladder-type networks is effective to reduce the hops length thus reduce total link cost. 
On the other hand, an effort for telco or ISP managed CDN to be connected each other has been also initiated by Cisco to form CDN federation \cite{federation} using open standard \cite{cdni}.
They argue that the current CDN architecture is not close enough to the users and ISP can fill this position.   

The idea to utilize user's computation power to support ISP operation is not new.  
The Figaro project \cite{figaro} proposed residential gateway as an integrator of different networks and services and become Internet-wide distributed content management for future Internet architecture \cite{figaro}. 
Cha, et al.,\cite{Cha:2008:NTP:1855641.1855646} performed trace analysis and found that IPTV architecture powered by P2P can handle much larger number of channels with limited demand for infrastructure compare to IP multicast. 
Jiang et al., \cite{Jiang:2012:OMD:2413176.2413193} proposed scalable and adaptive for content replication and request routing for CDN servers that located in users home gateway. 
Maki et al.,\cite{NaoyaMAKI2012} propose traffic engineering for peer-assisted CDN to control the behavior of clients and presents a solution for optimizing the selection of content files.
Mathieu et al., \cite{6249305} mentioned that in France telecom network, peer assisted delivery give great benefit. 
$5\%$ population of FTTH with $60\%$ upload rate can serve all networks for 600Kbps video stream.
A work by Mathieu et al., \cite{6249305} is the most relevant with our works.
Our work is same in system model architecture which uses different level of topologies  (Level-0 and Level-1), where in Mathieu et al., \cite{6249305} the authors use different names, which are regional and national. 
We emphasize that compare to  Mathieu et al., \cite{6249305} our work provides completely different approach.
Mathieu et al., \cite{6249305} mostly based on empirical data from France telecom company thus the authors can directly calculate network load caused by video traffic and calculate network load saving if peer-assisted CDN is employed,  while our study focus on mathematical model of different admission policies for peers to join peer-assisted CDN and ISP payoff can get from employing peer-assisted CDN.

%%%%%%%%%%%%%%%%% CONCLUSION %%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion and Future Work}\label{conclude}
This paper presents scheme for peer-assisted ISP managed CDN model that estimate lower bound of peers based on stochastic fluid model and estimate the economic incentive for ISP based on game theory.  
We have same observation with Mathieu et al., \cite{6249305}.  
Compare to discount price, We found that upload rate seeder has big influence to the system.
Finally, our numerical result shows that peer-assisted CDN managed by ISP or telco is feasible to deploy and does not harm to ISP business. 
Some areas of improvement that we have identified for future are:
more work on stochastic fluid model to include multiple video streaming bitrate and downtime effect of user home gateway and penalty to ISP payoff. 
We also very interested to include energy trade off this peer-assisted CDN architecture in order to know how much energy saving by ISP and how much increase of energy at users home gateway side in this architecture. 



%%%%%%%%%%%%%%%%% ACKNOWLEDGEMENT %%%%%%%%%%%%%%%%%%%%%
%\section*{Acknowledgements}
%We thank Joe Touch for suggestions.


\bibliographystyle{ieicetr}% bib style
\bibliography{jurnal}% your bib database

%\begin{thebibliography}{99}% more than 9 --> 99 / less than 10 --> 9
%\bibitem{}
%\end{thebibliography}

\profile[]{Mohamad Dikshie Fauzie}{%
was born in 1976. 
He received a bachelors degree and a master's degree from Institute of Technology Bandung, Indonesia.
He is currently a Ph.D candidate at Keio University's Shonan Fujisawa Campus.
}

\profile[]{Achmad Husni Thamrin}{%
is Assistant Professor at Keio University. 
He is a graduate of Keio University, Graduate School of Media and Governance (Ph.D 2005, MMG, 2002). 
His research interests include multicast, Internet over broadcast media, and peer-to-peer networks.
}

%\profile[photos/a3.eps]{Rodney Van Meter}{%
%received a B.S. from the California Institute of Technology in 1986,
%an M.S. from the University if Southern California in 1991, and
%a Ph.D. from Keio University in 2006. His research interests include
%storage systems, networking, post Moore's law computer architecture,
%and quantum computing. He is an Associate Professor of Environment and
%Information Studies at Keio University's Shonan Fujisawa Campus.
%}
\profile[]{Jun Murai}{%
was born in March 1955 in Tokyo. Graduated Keio University in 1979,
Department of Mathematics, Faculty of Science and Technology.
He received his M.S. for Computer Science from Keio University in 1981,
and received his Ph.D. in Computer Science, Keio University in 1987. 
He specializes in computer science, computer network, and computer 
communication. He is currently Dean of the Faculty of Environment and
Information Studies, Keio University since October 2009. Former
Vice-President of Keio University from May 2005 to May 2009. He was
an Executive Director of the Keio Research Institute at SFC, Keio
University from 1999 to 2005.
}
 
\end{document}
